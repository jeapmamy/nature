{# app/Resources/views/layout.html.twig #}

<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>{% block title %}NAO{% endblock %}</title>

	{% block stylesheets %} {# On charge le CSS de bootstrap depuis le site directement #}

	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> 
	<link rel="stylesheet" href="http://localhost/nature/web/assets/css/style.css">

	{% endblock %}
</head>

<body id="page-top" data-spy="scroll" data-target=".navbar">
	
	<div id="global">

		<header>
			<!-- Navigation
			================================================== -->
			<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
				<div class="container">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="{{ path('core_index') }}">
							Nos Amis les Oiseaux
						</a>
					</div>
					<div class="collapse navbar-collapse navbar-right">
						<ul class="nav navbar-nav">
							<li class="hidden">
								<a href="{{ path('core_index') }}"></a>
							</li>
							<li><a href="{{ path("core_searchEspece") }}">Recherche</a></li>
							<li><a href="#">Observation</a></li>
							<li><a href="#">Association</a></li>
							<li>
								{% if is_granted('ROLE_ADMIN') %}
									<a href="{{ path('core_admin') }}">Administration </a>
								{% endif %}
							</li>
							<li>
								{% if is_granted('ROLE_USER') %}
									<a href="{{ path('fos_user_security_logout') }}">Déconnexion <span class="glyphicon glyphicon-log-out"></span></a>
								{% else %}
									<a href="{{ path('fos_user_security_login') }}">Connexion <span class="glyphicon glyphicon-log-in"></span></a>
								{% endif %}
							</li>
						</ul>
					</div>
				</div>
			</div>
		</header>


		<!-- Corps
		================================================== -->
		{% if app.request.hasPreviousSession %}
			{% for type, messages in app.session.flashbag.all() %}
				{% for message in messages %}
					<div class="alert alert-{{ type }}">
						{{ message }}
					</div>
				{% endfor %}
			{% endfor %}
		{% endif %}

		<div id="content" class="container">
			<div class="col-md-12">
				{% block body %} {% endblock %}
			</div>
		</div>
	</div>


		<!-- Pied de Page
		================================================== -->
		<footer id="piedBlog">
			<div>
				NAO © {{ 'now'|date('Y') }} |
				<a href="#"> Mentions légales</a> |
				<a href="#"> Contact</a>
			</div>
		</footer>



	{% block javascripts %} 
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	  	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
			
		<script>  
			$("input[data-id=dallalien]").autocomplete({
			    source: function (request, response) {
					var company = $("input[data-id=dallalien]").val();
					var objData = 'company=' + company;
					var url = $(this.element).attr('data-url');
			           
		            $.ajax({
		                url: url,
		                dataType: "json",
		                data : objData,
		                type: 'POST',
		                success: function (data) {
		                    response($.map(data, function (item) {
		                        return {
		                        label: item.nomVern + ', ' + item.lbAuteur,
		                        value: item.id
		                        }
		                    }));
		                },
		                error: function (jqXHR, textStatus, errorThrown) {
		                    console.log(textStatus, errorThrown);
		                }
		            });
			    }
			})
			$("input[data-id=dallalien]").on('autocompleteselect',function(event, ui) {
				event.preventDefault();
				var contact = ui.item.label;
					id = ui.item.value;
			    	console.log('Event: ', event);
			    	console.log('UI :', ui.item);
			    	$(event.currentTarget).val(contact);
			})
			$.post('http://localhost/nature/web/app_dev.php/', {'id': id}, function(response){

			})
		</script>
	{% endblock %}

</body>

</html>
