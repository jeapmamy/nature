<?php

namespace CoreBundle\Repository;
use Doctrine\ORM\EntityRepository;
use Doctrine\ORM\QueryBuilder;

/**
 * ObservationRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ObservationRepository extends EntityRepository
{

	// Depuis un repository
	public function chercheObservation($id)
	{
		$qb = $this
		   ->createQueryBuilder('o')
		;  

		$qb->where('o.espece = :id')
			->setParameter('id', $id)
			->leftJoin('o.user', 'user')
			->addSelect('user')
			->leftJoin('o.image', 'image')
			->addSelect('image')
			->AndWhere('o.statut = 1')
		;

		return $qb
			->getQuery()
			->getArrayResult()
		;
	}
	
	public function chercheListe($id)
	{
		$qb = $this
		   ->createQueryBuilder('o')
		;  

		$qb->where('o.espece = :id')
			->setParameter('id', $id)
			->AndWhere('o.statut = 1')
			->orderBy('o.date', 'DESC')
		;

		return $qb
			->getQuery()
			->getResult()
		;
	}
	
	public function myFindBy()
	{
		
		$qb = $this
			->createQueryBuilder('o')
		;		

		$qb->where('o.statut = 0')
			->orderBy('o.date', 'DESC')
		;

		return $qb
			->getQuery()
			->getResult()
		;
	}	

}
